# DNS Zone
# resource "google_dns_managed_zone" "dev_us_west1" {
#   name        = "dev-northamerica-northeast1"
#   dns_name    = "dev-northamerica-northeast1.raizv.ca."
#   description = "Zone for dev-northamerica-northeast1 cluster"
#   project     = google_project.project.project_id
# }

# TLS cert
# resource "google_compute_managed_ssl_certificate" "dev_us_west1" {
#   provider = "google-beta"

#   name    = "dev-northamerica-northeast1"
#   project = google_project.project.project_id
#   managed {
#     domains = ["dev-northamerica-northeast1.raizv.ca."]
#   }
# }

# # Add dns.admin role to external-dns service account
# module "external_dns_service_account" {
#   source = "./modules/service_account"

#   name                  = "external-dns"
#   description           = "Service Account for External DNS service running in GKE"
#   project               = google_project.project.project_id
#   service_account_roles = ["roles/dns.admin"]
# }

# # Allow service account in GKE to use Workload Identity
# resource "google_project_iam_member" "external_dns_identity_user_role" {
#   project = google_project.project.project_id
#   role    = "roles/iam.workloadIdentityUser"
#   member  = "serviceAccount:${google_project.project.project_id}.svc.id.goog[kube-system/external-dns]"
# }
